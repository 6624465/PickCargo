@model PickC.Web.ViewModels.TripEstimateVm
@{
    ViewBag.Title = "Index";
}
<style type="text/css">
    #map-wrapper {
        width: 40.07%;
        min-height: 200px;
        display: inline-block;
        border: 1px solid lightgray;
        height: 55vh;
    }

    #dvMap {
        width: 100%;
        min-height: 45.2vh !important;
        height: 55vh;
    }

    .bg {
        background-image: url("../images/phone-bg.png");
        background-size: 100% 100%;
        height: 525px;
        position: absolute;
        top: 7px;
        width: 90%;
        max-width: 270px;
        z-index: 1;
        max-width: 263px;
    }

    .owl-carousel .owl-item img {
        height: 400px;
        position: relative;
        top: 60px;
        transform-style: preserve-3d;
        max-width: 260px;
    }

    .owl-carousel .owl-item img {
        height: 400px;
        position: relative;
        top: 60px;
        max-width: 260px;
        transform-style: preserve-3d;
    }

    .owl-stage-outer {
        height: 553px;
    }

    .animated {
        -webkit-animation-duration: 1000 ms;
        animation-duration: 1000 ms;
        -webkit-animation-fill-mode: both;
        animation-fill-mode: both;
    }

    .download-btn {
        background-color: transparent;
        border: 0 none;
        color: #fff;
        max-width: 200px;
        position: absolute;
        right: -10px;
        top: 26%;
        z-index: 9;
    }

        .download-btn img {
            width: 100%;
        }

        .download-btn:hover, .download-btn:active, .download-btn:focus {
            background-color: transparent;
            border: 0 none;
        }

    .owl-animated-out {
        z-index: 1;
    }

    .owl-animated-in {
        z-index: 0;
    }

    .fadeOut {
        -webkit-animation-name: fadeOut;
        animation-name: fadeOut;
    }

    .mobile-div {
        max-width: 260px;
        margin: 0px auto;
        width: 260px;
    }

    .marquee {
        font-size: 16px;
        background-color: rgb(37, 39, 46);
        border-bottom: 3px solid rgb(255, 252, 0);
        border-top: 3px solid rgb(255, 252, 0);
        color: rgb(37,39,46);
        margin-top: 4px;
        padding-top: 10px;
        font-family: 'chlubregular';
    }

    .marquee {
        color: rgb(255, 252, 0);
        font-family: "chlubregular";
        font-size: 49px;
        font-weight: normal;
        line-height: 30px;
    }
</style>
<script>



</script>
<div class="container-fluid marquee">
    <div class="row">
        <div class="col-xs-12  ">
            <div class="container">

                <div class="row">
                    <div class="col-xs-12  ">
                        <marquee direction="left" SCROLLDELAY="0" SCROLLAMOUNT="3"> India's best online logistics  app &nbsp;&nbsp; Download pick-c app now  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; India's best online logistics  app &nbsp;&nbsp; Download pick-c app now &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; India's best online logistics  app &nbsp;&nbsp; Download pick-c app now </marquee>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">

    <div class="row">
        <div class="col-xs-12 col-md-4 col-lg-3">
            <div class="mobile-div">
                <div class="custom owl-carousel owl-theme">
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n1.png")">
                    </div>
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n2.jpg")">
                    </div>
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n3.jpg")">
                    </div>
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n4.jpg")">
                    </div>
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n5.jpg")">
                    </div>
                    <div class="item">
                        <img class="img-responsive" src="@Url.Content("~/images/n6.jpg")">
                    </div>

                </div>
                @*<div class="owl-carousel mainslider" data-timeout="5000">
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n1.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n3.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n2.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n4.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n6.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content("~/images/n5.png")"></div>
                        <div class="item"><img class="img-responsive" src="@Url.Content(" ~/images/2.png")"></div>
                    </div>*@
                <div class="bg"></div>
            </div>
        </div>
        <div class="col-xs-12 col-md-4 col-lg-5">
            @using (Html.BeginForm("SaveBooking", "Bookings", FormMethod.Post, new { id = "frmTripEstimate", name = "frmTripEstimate" }))
            {
                <div class="go1">
                    <h2>Trip Estimate</h2>
                    <div class="qc-form">
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    <select class="form-control" id="City" name="City">
                                        <option data-tokens="hyderabad">Hyderabad</option>
                                        <option data-tokens="banglore">Banglore</option>
                                        <option data-tokens="pune">Pune</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    @Html.DropDownListFor(x =>
                                Model.booking.VehicleType,
                                new SelectList(Model.VehicleTypelookUpData, "LookupID", "LookupDescription"),
                                "Select Vehicle Type",
                                new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    @Html.DropDownListFor(x =>
                                Model.booking.VehicleGroup,
                                new SelectList(Model.VehicleGrouplookUpData, "LookupID", "LookupDescription"),
                                "Select Vehicle Group",
                                new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    @Html.TextBoxFor(x => Model.booking.LocationFrom, new { @class = "form-control", placeholder = "From Location" })
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    @Html.TextBoxFor(x => Model.booking.LocationTo, new { @class = "form-control", placeholder = "To Location" })
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-6">
                                <div class="form-group">
                                    @Html.TextBoxFor(x => Model.customer.Name, new { @class = "form-control", placeholder = "Name" })
                                    @*@if (ViewBag.isUserLoggedIn)
                                        {
                                            @Html.TextBoxFor(x => Model.customer.Name, new { @class = "form-control", placeholder = "Name" })
                                        }
                                        else
                                        {
                                            @Html.TextBoxFor(x => Model.customer.Name, new { @class = "form-control", placeholder = "Name", })
                                        }*@
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-6">
                                <div class="form-group">
                                    @Html.TextBoxFor(x => Model.customer.MobileNo, new { @class = "form-control", placeholder = "Mobile" })
                                    @*@if (ViewBag.isUserLoggedIn)
                                        {
                                            @Html.TextBoxFor(x => Model.customer.MobileNo, new { @class = "form-control", placeholder = "Mobile" })
                                        }
                                        else
                                        {
                                            @Html.TextBoxFor(x => Model.customer.MobileNo, new { @class = "form-control", placeholder = "Mobile" })
                                        }*@
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    @Html.TextBoxFor(x => Model.customer.EmailID, new { @class = "form-control", placeholder = "Email", type = "email" })
                                    @*@if (ViewBag.isUserLoggedIn)
                                        {
                                            @Html.TextBoxFor(x => Model.customer.EmailID, new { @class = "form-control", placeholder = "Email", type = "email" })
                                        }
                                        else
                                        {
                                            @Html.TextBoxFor(x => Model.customer.EmailID, new { @class = "form-control", placeholder = "Email", type = "email" })
                                        }*@
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group" id="RdDate">
                                    @Html.TextBoxFor(x => Model.booking.RequiredDate, new { @class = "form-control", placeholder = "Date" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <button onclick="GetRoute()" class="btn btn-default btn-submit btn-md ripple has-ripple" type="button">Get Trip Estimate</button>
                            <button type="reset" class="btn btn-default btn-submit btn-md ripple has-ripple"><i class="fa fa-refresh"></i> Clear</button>
                            @*<button class="btn btn-default btn-submit btn-md ripple has-ripple" onclick="onClickTripEstimate()"><i class="fa fa-refresh"></i> Clear</button>*@
                        </div>
                    </div>
                    @Html.HiddenFor(x => x.booking.Latitude)
                    @Html.HiddenFor(x => x.booking.Longitude)
                </div>
            }
        </div>
        <div class="col-xs-12 col-md-4 col-lg-4">
            <div class="row go" style="padding-bottom:10px;">
                <div class="col-md-6"><img class="img-responsive" src="@Url.Content("~/images/app.png")"></div>
                <div class="col-md-6"><img class="img-responsive" src="@Url.Content("~/images/goo.png")"></div>
            </div>
            <div class="statBlocks">
                <div class="row">
                    @if (!ViewBag.isUserLoggedIn)
                    {
                        <div class="col-md-6"><a href="@Url.Content("~/Account/Register")"><div class="statBlock"><span><i class="fa fa-user-plus"></i><h4>Register</h4></span></div></a></div>
                    }
                    @if (!ViewBag.isUserLoggedIn)
                    {
                        <div class="col-md-6"><a href="@Url.Content("~/Account/Login")"><div class="statBlock"><span><i class="fa fa-sign-in"></i><h4>Login</h4></span></div></a></div>
                    }
                    <div class="col-md-6"><a href="@Url.Content("~/Bookings/CustomerBookingHistory")"><div class="statBlock"><span><i class="fa fa-truck"></i><h4>Booking History</h4></span></div></a></div>
                    <div class="col-md-6"><a href="@Url.Content("~/Help/FindCRN")"><div class="statBlock"><span><i class="fa fa-map-marker"></i><h4>Track Your Cargo</h4></span></div></a></div>
                </div>
            </div>
            <div class="row driverimg">
                <div class="col-md-12">
                    <a data-toggle="modal" data-target="#Registration" style="cursor:pointer;">
                        <img src="~/images/Final-Register-Now.png" />
                    </a>
                    @*<button type="button" class="btn btn-default" ng-click="$ctrl.open()">Open me!</button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.open('lg')">Large modal</button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.open('sm')">Small modal</button>
                        <button type="button"
                                class="btn btn-default"
                                ng-click="$ctrl.open('sm', '.modal-parent')">
                            Modal appended to a custom parent
                        </button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.toggleAnimation()">Toggle Animation ({{ $ctrl.animationsEnabled }})</button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.openComponentModal()">Open a component modal!</button>
                        <button type="button" class="btn btn-default" ng-click="$ctrl.openMultipleModals()">
                            Open multiple modals at once
                        </button>*@

                </div>

            </div>
        </div>
    </div>
</div>
<div ng-show="$ctrl.selected">Selection from a modal: {{ $ctrl.selected }}</div>
<div class="modal-parent">
</div>
<div class="modal" id="tripEstimateModal">
    <div class="modal-dialog modal-md" style="width:900px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
                <h4 class="modal-title">Trip Estimate</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-6">
                        <div>
                            <div id="dvMap" style="height:300px;position: relative; overflow: hidden; background-color: rgb(229, 227, 223);"></div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="row">
                            <div class="col-lg-12">
                                <h5>Fare estimate</h5>
                                <span><i class="fa fa-inr" aria-hidden="true"></i>&nbsp;291 - <i class="fa fa-inr" aria-hidden="true"></i>&nbsp;352</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-4">
                                <h5>Vehicle</h5>
                                <span id="vehicleSelected">Tata Ace</span>
                            </div>
                            <div class="col-lg-4">
                                <h5>Estimate distance</h5>
                                <span id="estdistance">Tata Ace</span>
                            </div>
                            <div class="col-lg-4">
                                <h5>Estimate time</h5>
                                <span id="esttime">Tata Ace</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 pull-left ">
                                <h5>Pickup From</h5>
                                <span id="pickuparea"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 pull-left ">
                                <h5>Dropoff To</h5>
                                <span id="dropoffarea"></span>
                            </div>
                        </div>
                        <div class="row" style="margin-top:10px;">
                            <div class="col-lg-12 col-xs-12">
                                <button type="button" class="btn btn-default btn-submit btn-md ripple has-ripple" onclick="btnConfirmBooking();">Confirm Booking</button>
                                <button type="button" class="btn btn-default btn-submit btn-md ripple has-ripple" data-dismiss="modal">Cancel </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 pull-left ">
                                <h5>Write to us</h5>
                                <span id="pickuparea"><b>E-mail ID: info@pickcargo.in</b></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 pull-left ">
                                <h5>Call us</h5>
                                <span id="dropoffarea"> <b>Phone No:</b></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--<div class="modal-footer">
                <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-outline">Save changes</button>
            </div>-->
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<div id="Registration" class="modal fade">
    <div class="modal-dialog">
        <form id="frmImgRegister" name="frmImgRegister">
            <!-- Modal content-->
            <div class="modal-content" style="max-width:350px;">

                <div class="modal-body" style="min-height:100px; background:rgba(246,246,246,0.5); ">
                    <div class="row">
                        <div class="col-md-4 text-left ">
                            <label>Driver Name</label>
                        </div>  <div class="col-md-8 text-left">
                            <input class="form-control" id="DriverName" name="DriverName" type="text" value="">
                        </div>
                    </div><br />
                    <div class="row">
                        <div class="col-md-4 text-left">

                            <label>Mobile No.</label>
                        </div>  <div class="col-md-8 text-left">
                            <input class="form-control" id="MobileNo" name="MobileNo" type="text" value="">

                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-8 text-left col-md-offset-4">
                            <button type="button" onclick="btnSaveImageRegistration();" class="btn btn-default btn-submit btn-md ripple has-ripple">&nbsp;Submit</button>
                            <button type="button" onclick="Clear()" class="btn btn-default btn-submit btn-md ripple has-ripple"><i class="fa fa-refresh"></i>&nbsp;Clear</button>
                        </div>
                    </div>

                </div>
            </div>
        </form>
    </div>
</div>

<div id="DriverDescription" class="modal" style="height: calc(100%);">
    <div class="modal-dialog" style="height: calc(100%);">
        <form id="frmDriverDescription" name="frmDriverDescription" style="height: calc(100%); ">
            <!-- Modal content-->
            <div class="modal-content" style="height: calc(100%);">

                <div class="modal-body" style="min-height:100px; background:rgba(246,246,246,0.5); padding:0px; height: calc(100%);">
                    <div style="width:100%;height: calc(100% - 100px); background-image:url(../images/DriverDocument.png); background-size:100% 100%; height: calc(100%);">
                        @*<img id="myImg" src="@Url.Content("~/images/DriverDocument.png")" alt="Driver Document" style="width:100%; height:;">*@
                        @*<button type="button" class="download-btn btn btn-primary solid blank has-ripple"  onclick="DownloadImage()" style="font-size: 17px;font-weight: bold;">Download <i class="fa fa-download" aria-hidden="true"></i></button>*@
                        <a href="@Url.Content("~/images/RegisterNow.pdf")" class="download-btn btn btn-primary solid blank has-ripple" style="font-size: 17px;font-weight: bold; " alt="Pdf" target="_blank" download>
                            @*Download &nbsp; <i class="fa fa-download" aria-hidden="true"></i>*@
                            <img src="~/images/PDFDownloadButton.png" />
                        </a>
                    </div>
                </div>

            </div>
        </form>
    </div>
</div>
@section scripts {
    <script src="@Url.Content("~/js/DriverImage.js")"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7WVBL9AmhKs1QAr4x7mArA2mKZY-9nUo&v=3.exp&libraries=places&sensor=true"></script>
    <script type="text/javascript">
        var source, destination;
        var directionsDisplay;
        var options = {};
        //var defaultBounds = new google.maps.LatLngBounds(
        //                new google.maps.LatLng(6, 96),
        //                new google.maps.LatLng(36, 68));
        var southWest = new google.maps.LatLng(52.318274, 4.728856);
        var northEast = new google.maps.LatLng(52.431157, 5.068373);
        var defaultBounds = new google.maps.LatLngBounds(southWest, northEast);
        options = {
            bounds: defaultBounds,
            types: ['address'],//geocode
            componentRestrictions: { country: 'in' }
        };
        var directionsService = new google.maps.DirectionsService();
        google.maps.event.addDomListener(window, 'load', function () {
            new google.maps.places.Autocomplete(document.getElementById('booking_LocationFrom'), options);
            new google.maps.places.Autocomplete(document.getElementById('booking_LocationTo'), options);
            directionsDisplay = new google.maps.DirectionsRenderer({ 'draggable': true });
        });
        sessionStorage.setItem("isUserLoggedIn", "@ViewBag.isUserLoggedIn");
        $(function () {
            $('#booking_RequiredDate').datetimepicker({
                format: 'DD/MM/YYYY hh:mm'
            });
            //$(function () {
            //    $('#frmImgRegister').validate({
            //        rules: {
            //            DriverName: {
            //                required: true
            //            },
            //            MobileNo: {
            //                required: true
            //            }
            //        }
            //    });
            //});

            $('#frmTripEstimate').validate({
                rules: {
                    City: {
                        required: true
                    },
                    'booking.VehicleType': {
                        required: true
                    },
                    'booking.VehicleGroup': {
                        required: true
                    },
                    'booking.LocationFrom': {
                        required: true
                    },
                    'booking.LocationTo': {
                        required: true
                    },
                    'booking.RequiredDate': {
                        required: true
                    }
                }
            });
        });

        function GetRoute() {

            /*
            if (!$('#frmTripEstimate').valid()) {
                $('#alertInfo').hide();
                $('#alertErrMsg').text('Please enter all mandatory fields.!');
                $('#alertErr').fadeIn();

                setTimeout(function () {
                    $('#alertErr').hide();
                    $('#alertInfo').fadeIn();
                }, 5000);
                return;
            }
            debugger;*/
            if ($('#frmTripEstimate').valid())
                DrawMapNew($('#booking_LocationFrom').val(), $('#booking_LocationTo').val());
        }

        function DrawMapNew(start, end) {
            $('#pickuparea').html(start);
            $('#dropoffarea').html(end);
            document.getElementById('dvMap').style.height = '470px';
            var mapDiv = document.getElementById('dvMap');
            var latlng = new google.maps.LatLng(26.90, 76.35);
            var options = {
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                navigationControl: true,
                scaleControl: true,
                disableDoubleClickZoom: true,
                scrollwheel: false,
                streetViewControl: true
            };
            var waypts = [];
            var request = {
                origin: start,
                destination: end,
                waypoints: waypts,
                optimizeWaypoints: false,
                travelMode: google.maps.DirectionsTravelMode.DRIVING,
                unitSystem: google.maps.DirectionsUnitSystem.METRIC
            };

            directionsService = new google.maps.DirectionsService();
            directionsService.route(request, function (response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    debugger;
                    $('#booking_Latitude').val(response.routes[0].legs[0].start_location.lat());
                    $('#booking_Longitude').val(response.routes[0].legs[0].start_location.lng());
                    $('#estdistance').html(response.routes[0].legs[0].distance.text);
                    $('#esttime').html(response.routes[0].legs[0].duration.text);
                    //var Dist = response.routes[0].legs[0].distance.text;
                    //var Time = response.routes[0].legs[0].duration.text;
                    //document.getElementById("duration1").innerHTML = Time;
                    //document.getElementById("duration2").innerHTML = Time;
                    //document.getElementById("distancesone").innerHTML = Dist;
                    //document.getElementById("distancestwo").innerHTML = Dist;
                }

                map = new google.maps.Map(mapDiv, options);
                /*  var adUnitDiv = document.createElement('div');



                  var adUnitOptions = {

                      format: google.maps.adsense.AdFormat.BUTTON,

                      position: google.maps.ControlPosition.RIGHT_BOTTOM,

                      publisherId: 'ca-pub-5545853276936929',

                      map: map,

                      visible: true

                  };

                  var adUnit = new google.maps.adsense.AdUnit(adUnitDiv, adUnitOptions);*/



                directionsDisplay = new google.maps.DirectionsRenderer({

                });
                directionsDisplay.setMap(map);
                directionsDisplay.setPanel(document.getElementById('panel'));
                directionsDisplay.setDirections(response);
            });
            $('#tripEstimateModal').modal('show');
        }
        function onClickTripEstimate() {
            $('#City').val("");
            $('#booking_VehicleType').val("");
            $('#booking_VehicleGroup').val("");
            $('#booking_LocationFrom').val("");
            $('#booking_LocationTo').val("");
            $('#customer_Name').val("");
            $('#customer_MobileNo').val("");
            $('#customer_EmailID').val("");
            $('#booking_RequiredDate').val("");
        };

        function btnConfirmBooking() {
            @if(ViewBag.isUserLoggedIn)
            {
                <text>$('#frmTripEstimate').submit();</text>
            }
            else
            {
                <text>location.href = '@Url.Content("~/Account/Login")'</text>
            }
        }
        @*@if(ViewBag.isUserLoggedIn)
          {
              <text> $('#RdDate').data("DateTimePicker").maxDate(moment().endOf('today'));</text>
          }
        $('#RdDate').data("DateTimePicker").maxDate(moment().endOf('today'));*@
    </script>
}

